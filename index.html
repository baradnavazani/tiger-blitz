<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tiger Blitz</title>
    <script src="https://webappcontent.telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { margin: 0; background: #0a0a0a; color: white; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; overflow: hidden; }
        #score { font-size: 50px; font-weight: bold; color: #ff9800; margin-bottom: 20px; }
        .tiger-btn { width: 250px; height: 250px; border-radius: 50%; border: 6px solid #222; overflow: hidden; box-shadow: 0 0 30px rgba(255,152,0,0.3); transition: transform 0.1s; cursor: pointer; }
        .tiger-btn:active { transform: scale(0.95); }
        .tiger-btn img { width: 100%; height: 100%; object-fit: cover; }
        .energy-bar { width: 80%; height: 12px; background: #222; border-radius: 6px; margin-top: 40px; }
        #fill { height: 100%; background: #ff9800; width: 100%; border-radius: 6px; transition: width 0.2s; }
        /* لودینگ را مخفی پیش‌فرض می‌کنیم */
        #loader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #0a0a0a; display: none; align-items: center; justify-content: center; z-index: 1000; }
    </style>
</head>
<body>

    <div id="loader">
        <div style="border: 4px solid #333; border-top-color: #ff9800; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite;"></div>
    </div>

    <div style="color: #888; font-size: 12px;">TOTAL BALANCE</div>
    <div id="score">0</div>

    <div class="tiger-btn" onclick="tap()">
        <img src="tiger.png" onerror="this.src='https://placehold.co/400x400/orange/white?text=TIGER'">
    </div>

    <div class="energy-bar"><div id="fill"></div></div>
    <div id="status" style="margin-top: 10px; font-size: 14px;">1000 / 1000</div>

    <script>
        // خطایابی دستی: اگر تلگرام لود نشد، بازی کرش نکند
        let tg = (window.Telegram && window.Telegram.WebApp) ? window.Telegram.WebApp : null;
        
        if(tg) {
            tg.ready();
            tg.expand();
        }

        let coins = parseInt(localStorage.getItem('t_c')) || 0;
        let nrg = 1000;

        function update() {
            document.getElementById('score').innerText = coins.toLocaleString();
            document.getElementById('fill').style.width = (nrg / 10) + '%';
            document.getElementById('status').innerText = nrg + " / 1000";
        }

        function tap() {
            if (nrg > 0) {
                coins++;
                nrg--;
                localStorage.setItem('t_c', coins);
                update();
                if(tg && tg.HapticFeedback) tg.HapticFeedback.impactOccurred('medium');
            }
        }

        setInterval(() => { if(nrg < 1000) { nrg++; update(); } }, 1500);
        
        // اجرای بدون وقفه
        window.onload = update;
    </script>
    <style>@keyframes spin { to { transform: rotate(360deg); } }</style>
</body>
</html>
